pkgname=gtk2
pkgver=2.24.32
vcs=git
vcs_pkgname=gtk
gittag=${pkgver}
relmon_id=13942
updater_rules='skip_big_second'

build() {
    rm -rf docs
    sed -i -e '/docs\//d' configure.ac
    sed -i -e '/GTK_DOC_CHECK/d' configure.ac
    sed -i -e 's/automake-1.15/automake-1.16/g' autogen.sh
    sed -i -e 's/aclocal-1.15/aclocal-1.16/g' autogen.sh
    sed -i -e 's/gtkdocize/true/g' autogen.sh
    sed -i -e 's/docs //g' Makefile.am
    sed -i -e '/gtk-doc.make/d' Makefile.am
    NOCONFIGURE=1 ./autogen.sh
    sed -i -e 's/docs //g' Makefile.am
    sed -i -e '/gtk-doc.make/d' Makefile.am Makefile.in

    ./configure --prefix=/usr \
        --sysconfdir=/etc \
        --disable-man \
        --disable-cups \
        --libdir=/usr/lib
    make
}

package() {
    make DESTDIR=${pkgdir} install
    # fix conflict with gtk3
    mv ${pkgdir}/usr/bin/gtk{,2}-update-icon-cache
}
