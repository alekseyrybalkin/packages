pkgname=linux
vcs=git
pkgver=5.5.1
ARCH_VERSION=${pkgver}.arch1
gittag=v${pkgver}
relmon_id=6501

build() {
    # cgroup: init_tasks shouldn't be linked to the root cgroup
    git cherry-pick 0cd9d33ace336bc424fc30944aa3defd6786e4fe

    make mrproper
    cp -v ../config-x86_64 .config
    make
    if [ -z "${DISABLE_SPHINX}" ]; then
        make htmldocs
    fi
}

package() {
    mkdir -pv ${pkgdir}/boot
    cp -v arch/x86_64/boot/bzImage ${pkgdir}/boot/vmlinuz-jinni
    cp -v arch/x86_64/boot/bzImage ${pkgdir}/boot/vmlinuz-arch
    if [ -z "${DISABLE_SPHINX}" ]; then
        mkdir -pv ${pkgdir}/usr/share/doc
        cp -r Documentation/output ${pkgdir}/usr/share/doc/linux
    fi
}
