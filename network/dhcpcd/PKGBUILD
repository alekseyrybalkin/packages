pkgname=dhcpcd
pkgver=9.3.0
vcs=git
gittag=dhcpcd-${pkgver}
relmon_id=11429

build() {
    ./configure --libexecdir=/usr/lib/dhcpcd \
        --dbdir=/run \
        --sbindir=/usr/bin \
        --sysconfdir=/etc
    make
}

package() {
    make DESTDIR=${pkgdir} install
    mv ${pkgdir}/lib/dhcpcd/* ${pkgdir}/usr/lib/dhcpcd
    rm -rf ${pkgdir}/{lib,var,run}

    mv -v ${pkgdir}/etc/dhcpcd.conf{,.packaged}
}

after_install() {
    getent group dhcpcd >/dev/null || groupadd -g 970 dhcpcd
    getent passwd dhcpcd >/dev/null || \
        useradd -c 'dhcpcd' -d /var/lib/dhcpcd -g dhcpcd \
        -s /bin/false -u 970 dhcpcd
    chown -R dhcpcd:dhcpcd /var/lib/dhcpcd &> /dev/null
    chmod 700 /var/lib/dhcpcd &> /dev/null
}

after_upgrade() {
    after_install
}
