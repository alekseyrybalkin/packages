pkgname=python-lxml
pkgver=4.5.1
vcs=git
vcs_pkgname=lxml
gittag=lxml-${pkgver}
relmon_id=3914

build() {
    # python3
    sed -i -e 's/itervalues/values/g' doc/mkhtml.py

    if [ -z "${DISABLE_SPHINX}" ]; then
        cd doc
        python mkhtml.py html .. ${pkgver}
    fi
}

package() {
    pip install \
        --no-deps \
        --no-build-isolation \
        --ignore-installed \
        --compile \
        --prefix=/usr \
        --root=${pkgdir} .

    if [ -z "${DISABLE_SPHINX}" ]; then
        mkdir -p ${pkgdir}/usr/share/doc
        cp -r doc/html ${pkgdir}/usr/share/doc/python-lxml
    fi
}
