pkgname=python-jinja
pkgver=2.11.2
vcs=git
vcs_pkgname=jinja
gittag=${pkgver}
relmon_id=3894

build() {
    patch -Np1 -i ../sphinx-remove-pallets.diff
    if [ -z "${DISABLE_SPHINX}" ]; then
        cd docs
        make html
    fi
}

package() {
    pip install \
        --no-deps \
        --no-build-isolation \
        --ignore-installed \
        --compile \
        --prefix=/usr \
        --root=${pkgdir} .

    if [ -z "${DISABLE_SPHINX}" ]; then
        mkdir -pv ${pkgdir}/usr/share/doc
        cp -r docs/_build/html ${pkgdir}/usr/share/doc/python-jinja
    fi
}
